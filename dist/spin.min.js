!function(){var t=0,e=["ms","moz","webkit","o"],a=0;for(a=0;a<e.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[e[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[a]+"CancelAnimationFrame"]||window[e[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var a=(new Date).getTime(),n=Math.max(0,16-(a-t)),i=window.setTimeout(function(){e(a+n)},n);return t=a+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var Spinner=function(t){var e;this.ms_per_frame=2.778;try{this.ctx=e=document.getElementById(t.canvas_id).getContext("2d")}catch(a){throw new Error("couldn't find <canvas> context, canvas id was: \""+t.canvas_id+'"')}if(this.width=e.canvas.width,this.max_radius=this.width/2,this.width!==e.canvas.height)throw new Error("<canvas> must be square, width must equal height.");this.segment_angle=t.segment_angle||20,this.segment_gap_angle=t.segment_gap_angle||0,this.segment_max_angle=t.segment_max_angle||240,this.segment_max_angle++;var n=.66*this.max_radius;this.segment_radius=t.segment_radius?t.segment_radius>this.max_width?n:t.segment_radius:n,this.segment_depth=t.segment_depth||1,this.foreground=t.foreground||[221,72,20],this.speed=t.speed||1};Spinner.prototype={play:function(){var t=this.ctx,e=this.max_radius;this.start=Date.now(),t.setTransform(1,0,0,1,0,0),t.translate(e,e),this.frame()},frame:function(){var t=this.ctx,e=Date.now(),a=e-this.start,n=Math.PI/180*(a/(1/this.speed*this.ms_per_frame));this.start=e,this.clear(),t.rotate(n),this._draw_cone();var i=this.frame.bind(this);this.animationFrame=window.requestAnimationFrame(i)},_rgba:function(t,e){var a;return a=t.concat(e),"rgba("+a.join()+")"},_draw_cone:function(){var t=this.ctx,e=this.segment_radius,a=Math.abs(this.segment_radius-this.segment_depth),n=this.segment_angle+this.segment_gap_angle,i=(this.segment_max_angle-1)/10,s=0,r=0;for(t.save();s<this.segment_max_angle;s+=n)r=(s/i|0)/10,t.fillStyle=this._rgba(this.foreground,r),this._draw_segment(this.segment_angle,a,e),t.rotate(Math.PI/180*n);t.restore()},_draw_segment:function(t,e,a){var n=this.ctx,i=Math.PI/180*t,s=Math.PI/180*270,r=s+i;n.beginPath(),n.moveTo(0,-e),n.lineTo(0,-a),n.arc(0,0,a,s,r),n.lineTo(Math.sin(i)*e,-(Math.cos(i)*e)),n.arc(0,0,e,r,s,!0),n.closePath(),n.fill()},clear:function(){var t=this.ctx;t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.width,this.width),t.restore()},stop:function(){window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0}};
